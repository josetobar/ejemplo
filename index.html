<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Predictor de Notas Estudiantiles (Regresi贸n Lineal)</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;500;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #f8f9fa; /* Gris muy claro */
            color: #343a40; /* Texto oscuro */
        }
        .header-section {
            background-color: #ffffff;
            border-bottom: 3px solid #0d6efd;
            padding: 30px 0;
            margin-bottom: 20px;
        }
        h1, h4 {
            font-weight: 700;
        }
        .container-form {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); /* Sombra elegante */
        }
        .border-bottom {
            border-color: #ced4da !important; /* Separadores sutiles */
        }
        #resultado {
            font-weight: 700;
            font-size: 3.5rem;
            text-align: center;
            color: #0d6efd; /* Azul principal */
            margin-top: 30px;
            padding: 20px;
            border: 2px solid #e9ecef; /* Borde suave */
            border-radius: 8px;
        }
        .form-label {
            font-weight: 500;
            color: #495057;
        }
    </style>
</head>
<body>
    
    <main>
        <div class="header-section text-center">
            <h1 class="display-5 fw-bold"> Predicci贸n de Nota Final</h1>
            <div class="col-lg-8 mx-auto">
                <p class="lead mb-0 mt-2">Introduce las caracter铆sticas del estudiante para predecir su calificaci贸n de examen final.</p>
            </div>
        </div>

        <div class="container mt-4 mb-5">
            <div class="row">
                <div class="col-12 col-lg-10 offset-lg-1">
                    
                    <form id="predictionForm" onsubmit="event.preventDefault(); predecirNota();" class="container-form">
                        <div class="row g-4">
                            
                            <h4 class="mt-4 border-bottom pb-2 text-primary"> Estudio y Asistencia</h4>
                            <div class="col-md-6">
                                <label for="Hours_Studied" class="form-label">1. Horas de Estudio (por semana)</label>
                                <input type="number" class="form-control" id="Hours_Studied" value="5" required>
                            </div>
                            <div class="col-md-6">
                                <label for="Attendance" class="form-label">2. Asistencia (%)</label>
                                <input type="number" class="form-control" id="Attendance" value="75" required>
                            </div>
                            
                            <h4 class="mt-4 border-bottom pb-2 text-primary"> Factores del Hogar</h4>
                            <div class="col-md-6">
                                <label for="Parental_Involvement" class="form-label">3. Participaci贸n Parental (0=Bajo, 1=Medio, 2=Alto)</label>
                                <input type="number" class="form-control" id="Parental_Involvement" value="1" min="0" max="2" required>
                            </div>
                            <div class="col-md-6">
                                <label for="Family_Income" class="form-label">11. Ingresos Familiares (0=Alto, 1=Bajo, 2=Medio)</label>
                                <input type="number" class="form-control" id="Family_Income" value="2" min="0" max="2" required>
                            </div>
                            <div class="col-md-6">
                                <label for="Parental_Education_Level" class="form-label">17. Nivel Educativo Padres (0=Prepa, 1=Posgrado, 2=Universidad)</label>
                                <input type="number" class="form-control" id="Parental_Education_Level" value="2" min="0" max="2" required>
                            </div>
                            <div class="col-md-6">
                                <label for="Distance_from_Home" class="form-label">18. Distancia del Hogar (0=Cerca, 1=Lejana, 2=Moderada)</label>
                                <input type="number" class="form-control" id="Distance_from_Home" value="2" min="0" max="2" required>
                            </div>

                            <h4 class="mt-4 border-bottom pb-2 text-primary"> Entorno y Habilidades</h4>
                            <div class="col-md-4">
                                <label for="Previous_Scores" class="form-label">7. Calificaciones Anteriores</label>
                                <input type="number" class="form-control" id="Previous_Scores" value="80" required>
                            </div>
                            <div class="col-md-4">
                                <label for="Motivation_Level" class="form-label">8. Nivel de Motivaci贸n (0=Alto, 1=Bajo, 2=Medio)</label>
                                <input type="number" class="form-control" id="Motivation_Level" value="2" min="0" max="2" required>
                            </div>
                            <div class="col-md-4">
                                <label for="Tutoring_Sessions" class="form-label">10. Sesiones de Tutor铆a (al mes)</label>
                                <input type="number" class="form-control" id="Tutoring_Sessions" value="2" required>
                            </div>
                            <div class="col-md-4">
                                <label for="Sleep_Hours" class="form-label">6. Horas de Sue帽o</label>
                                <input type="number" class="form-control" id="Sleep_Hours" value="8" required>
                            </div>
                            <div class="col-md-4">
                                <label for="Physical_Activity" class="form-label">15. Actividad F铆sica (horas/sem)</label>
                                <input type="number" class="form-control" id="Physical_Activity" value="4" required>
                            </div>
                            <div class="col-md-4">
                                <label for="Gender" class="form-label">19. G茅nero (0=Mujer, 1=Hombre)</label>
                                <input type="number" class="form-control" id="Gender" value="0" min="0" max="1" required>
                            </div>
                            
                            <h4 class="mt-4 border-bottom pb-2 text-primary"> Entorno Escolar</h4>
                            <div class="col-md-4">
                                <label for="Access_to_Resources" class="form-label">4. Acceso a Recursos (0=Alto, 1=Bajo, 2=Medio)</label>
                                <input type="number" class="form-control" id="Access_to_Resources" value="0" min="0" max="2" required>
                            </div>
                            <div class="col-md-4">
                                <label for="Extracurricular_Activities" class="form-label">5. Extracurricular (0=No, 1=S铆)</label>
                                <input type="number" class="form-control" id="Extracurricular_Activities" value="1" min="0" max="1" required>
                            </div>
                            <div class="col-md-4">
                                <label for="Internet_Access" class="form-label">9. Acceso a Internet (0=No, 1=S铆)</label>
                                <input type="number" class="form-control" id="Internet_Access" value="1" min="0" max="1" required>
                            </div>
                            <div class="col-md-4">
                                <label for="Teacher_Quality" class="form-label">12. Calidad Docente (0=Alto, 1=Bajo, 2=Medio)</label>
                                <input type="number" class="form-control" id="Teacher_Quality" value="0" min="0" max="2" required>
                            </div>
                            <div class="col-md-4">
                                <label for="School_Type" class="form-label">13. Tipo de Escuela (0=Privada, 1=P煤blica)</label>
                                <input type="number" class="form-control" id="School_Type" value="1" min="0" max="1" required>
                            </div>
                            <div class="col-md-4">
                                <label for="Peer_Influence" class="form-label">14. Influencia Pares (0=Negativa, 1=Neutral, 2=Positiva)</label>
                                <input type="number" class="form-control" id="Peer_Influence" value="2" min="0" max="2" required>
                            </div>
                            <div class="col-md-4">
                                <label for="Learning_Disabilities" class="form-label">16. Discapacidades (0=No, 1=S铆)</label>
                                <input type="number" class="form-control" id="Learning_Disabilities" value="0" min="0" max="1" required>
                            </div>
                            
                            <div class="col-12 mt-4 text-center">
                                <button type="submit" class="btn btn-primary btn-lg px-4 gap-3">Predecir Calificaci贸n</button>
                            </div>
                        </div>
                    </form>

                    <div id="resultado" class="text-center py-4">
                        -- Nota Predicha --
                    </div>
                    
                </div>
            </div>
        </div>

        <footer class="bg-dark text-secondary px-4 py-2 text-center mt-5">
            <div class="py-3">
                <p class="fs-6 mb-0 text-white-50">Modelo de Regresi贸n Lineal generado con Scikit-learn y exportado con m2cgen.</p>
            </div>
        </footer>
    </main>
<script>
    
    const INPUT_IDS = [
        'Hours_Studied', 'Attendance', 'Parental_Involvement', 'Access_to_Resources', 'Extracurricular_Activities', 
        'Sleep_Hours', 'Previous_Scores', 'Motivation_Level', 'Internet_Access', 'Tutoring_Sessions', 
        'Family_Income', 'Teacher_Quality', 'School_Type', 'Peer_Influence', 'Physical_Activity', 
        'Learning_Disabilities', 'Parental_Education_Level', 'Distance_from_Home', 'Gender'
    ];

    async function predecirNota() {
        const outputDiv = document.getElementById("resultado");
        outputDiv.innerHTML = "Cargando...";
        
        const datos_json = {};
        
        // 1. Recolectar datos y construir el objeto JSON en el orden correcto
        for (const id of INPUT_IDS) {
            const valor = parseFloat(document.getElementById(id).value);
            if (isNaN(valor)) {
                outputDiv.innerHTML = "Error: Por favor, revisa todos los campos.";
                alert(`Por favor, ingresa un valor num茅rico v谩lido para ${document.querySelector('label[for="' + id + '"]').textContent}`);
                return;
            }
            // Mapeamos el valor al nombre de la columna para enviarlo al API
            datos_json[id] = valor; 
        }
        
        // 2. Enviar la petici贸n a la API REST
        try {
            const response = await fetch('https://noneagerly-leadless-casen.ngrok-free.dev/predict', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(datos_json)
            });

            const data = await response.json();

            if (response.ok) {
                // xito: Mostrar la nota predicha
                const nota_final = Math.round(data.nota_predicha);
                outputDiv.innerHTML = `Nota Predicha: ${nota_final}`;
            } else {
                // Error del servidor (ej. modelo no cargado, error de datos)
                console.error("Error de la API:", data.error);
                outputDiv.innerHTML = `Error: ${data.error || 'No se pudo contactar al servidor.'}`;
            }

        } catch (error) {
            // Error de conexi贸n (la API no est谩 corriendo o el puerto es incorrecto)
            console.error("Error de conexi贸n:", error);
            outputDiv.innerHTML = "Error de conexi贸n: Aseg煤rate que la API de Flask est茅 corriendo en https://noneagerly-leadless-casen.ngrok-free.dev/predict";
        }
    }
</script>

</body>
</html>


